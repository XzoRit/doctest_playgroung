import testing ;
import feature : feature ;

SOURCES = calculator leap_year test_main ;

feature enable-tests : no yes : optional ;

lib lib_impl
    : $(SOURCES).cpp
    : <include>../../doctest/doctest
      <enable-tests>no:<define>DOCTEST_CONFIG_DISABLE
    ;

alias lib
    : lib_impl/<enable-tests>no
    ;

exe test_lib
    : lib_impl/<enable-tests>yes
    ;

unit-test exec_tests
    : test_lib
    : <testing.arg>"-dt-s"
    ;

always exec_tests ;
